project: "Purdue Model Architecture (ICS-2024_6)"
version: 1.1

# Colors extracted or adapted for the model
styles:
  internet: "#4fc3f7" # Light Blue
  firewall: "#e64a19" # Deep Orange
  level_4:  "#f5f5f5" # Grey
  level_3:  "#f5f5f5" # Grey
  level_2:  "#f5f5f5" # Grey
  level_1:  "#f5f5f5" # Grey
  level_0:  "#f5f5f5" # Grey

zones:
  # --- Level 5: Internet DMZ ---
  - id: "ZONE_L5"
    label: "Level 5: Internet DMZ"
    style: "internet"
    assets:
      - id: "INTERNET"
        label: "Internet"
        ip: "Public"
      - id: "WEB_SVR"
        label: "Web servers"
        ip: "10.5.0.10"
      - id: "EMAIL_SVR"
        label: "Email"
        ip: "10.5.0.20"
      - id: "FW_L5"
        label: "Firewall (Perimeter)"
        style: "firewall"
        ip: "10.5.0.1"
        criticality: "High"

  # --- Level 4: Enterprise Admin ---
  - id: "ZONE_L4"
    label: "Level 4: Enterprise Admin"
    style: "level_4"
    assets:
      - id: "L4_AUTH"
        label: "Authentication"
        ip: "10.4.0.10"
        criticality: "Critical"
      - id: "L4_DSK"
        label: "Desktops"
        ip: "DHCP (10.4.0.100-200)"
      - id: "L4_DB"
        label: "Databases"
        ip: "10.4.0.20"
      - id: "L4_FILE"
        label: "File servers"
        ip: "10.4.0.30"
      - id: "L4_SW"
        label: "Ethernet switch"
        ip: "10.4.0.2"
      - id: "FW_L4"
        label: "Firewall (Enterprise)"
        style: "firewall"
        ip: "10.4.0.1"
        criticality: "High"

  # --- Level 3: Ops Admin ---
  - id: "ZONE_L3"
    label: "Level 3: Ops Admin"
    style: "level_3"
    assets:
      - id: "L3_HIST"
        label: "Historian"
        ip: "10.3.0.10"
        criticality: "High"
      - id: "L3_DC"
        label: "Domain controller"
        ip: "10.3.0.11"
        criticality: "Critical"
      - id: "L3_MON"
        label: "Monitoring"
        ip: "10.3.0.12"
      - id: "L3_3RD"
        label: "3rd Party"
        ip: "10.3.0.50"
      - id: "L3_SW"
        label: "Ethernet switch"
        ip: "10.3.0.2"
      # Firewalls separating L3 from L2 Cells
      - id: "FW_CELL1"
        label: "Firewall (Cell 1)"
        style: "firewall"
        ip: "10.3.1.1"
      - id: "FW_CELL2"
        label: "Firewall (Cell 2)"
        style: "firewall"
        ip: "10.3.2.1"
      - id: "FW_CELL3"
        label: "Firewall (Cell 3)"
        style: "firewall"
        ip: "10.3.3.1"

  # --- Level 2: Supervisory (3 Cells) ---
  - id: "ZONE_L2"
    label: "Level 2: Supervisory"
    style: "level_2"
    assets:
      # Cell 1 (Subnet 10.2.1.x)
      - id: "C1_DCS"
        label: "DCS System (Cell 1)"
        ip: "10.2.1.10"
        criticality: "Critical"
      - id: "C1_L2_SW1"
        label: "Ethernet Switch (Cell 1 Top)"
        ip: "10.2.1.2"
      - id: "C1_IPC"
        label: "Industrial PC (Cell 1)"
        ip: "10.2.1.20"
      - id: "C1_HMI"
        label: "Local HMI (Cell 1)"
        ip: "10.2.1.30"
      - id: "C1_L2_SW2_L"
        label: "Ethernet Switch (Cell 1 Left)"
        ip: "10.2.1.3"
      - id: "C1_L2_SW2_R"
        label: "Ethernet Switch (Cell 1 Right)"
        ip: "10.2.1.4"

      # Cell 2 (Subnet 10.2.2.x)
      - id: "C2_DCS"
        label: "DCS System (Cell 2)"
        ip: "10.2.2.10"
      - id: "C2_L2_SW1"
        label: "Ethernet Switch (Cell 2 Top)"
        ip: "10.2.2.2"
      - id: "C2_IPC"
        label: "Industrial PC (Cell 2)"
        ip: "10.2.2.20"
      - id: "C2_HMI"
        label: "Local HMI (Cell 2)"
        ip: "10.2.2.30"
      - id: "C2_L2_SW2_L"
        label: "Ethernet Switch (Cell 2 Left)"
        ip: "10.2.2.3"
      - id: "C2_L2_SW2_R"
        label: "Ethernet Switch (Cell 2 Right)"
        ip: "10.2.2.4"

      # Cell 3 (Subnet 10.2.3.x)
      - id: "C3_DCS"
        label: "DCS System (Cell 3)"
        ip: "10.2.3.10"
      - id: "C3_L2_SW1"
        label: "Ethernet Switch (Cell 3 Top)"
        ip: "10.2.3.2"
      - id: "C3_IPC"
        label: "Industrial PC (Cell 3)"
        ip: "10.2.3.20"
      - id: "C3_HMI"
        label: "Local HMI (Cell 3)"
        ip: "10.2.3.30"
      - id: "C3_L2_SW2_L"
        label: "Ethernet Switch (Cell 3 Left)"
        ip: "10.2.3.3"
      - id: "C3_L2_SW2_R"
        label: "Ethernet Switch (Cell 3 Right)"
        ip: "10.2.3.4"

  # --- Level 1: Control ---
  - id: "ZONE_L1"
    label: "Level 1: Control"
    style: "level_1"
    assets:
      # Cell 1
      - id: "C1_PLC_L"
        label: "PLC (Cell 1 Left)"
        ip: "10.2.1.50"
        criticality: "Critical"
      - id: "C1_PLC_R"
        label: "PLC (Cell 1 Right)"
        ip: "10.2.1.51"
        criticality: "Critical"
      # Cell 2
      - id: "C2_PLC_L"
        label: "PLC (Cell 2 Left)"
        ip: "10.2.2.50"
      - id: "C2_PLC_R"
        label: "PLC (Cell 2 Right)"
        ip: "10.2.2.51"
      # Cell 3
      - id: "C3_PLC_L"
        label: "PLC (Cell 3 Left)"
        ip: "10.2.3.50"
      - id: "C3_PLC_R"
        label: "PLC (Cell 3 Right)"
        ip: "10.2.3.51"

  # --- Level 0: Process ---
  - id: "ZONE_L0"
    label: "Level 0: Process"
    style: "level_0"
    assets:
      # Cell 1
      - id: "C1_ACT"
        label: "Actuator (Cell 1)"
        ip: "N/A (Hardwired)"
      - id: "C1_PUMP"
        label: "Pump (Cell 1)"
        ip: "N/A (Hardwired)"
      - id: "C1_SENS"
        label: "Sensor (Cell 1)"
        ip: "N/A (Hardwired)"
      # Cell 2
      - id: "C2_ACT"
        label: "Actuator (Cell 2)"
        ip: "N/A (Hardwired)"
      - id: "C2_PUMP"
        label: "Pump (Cell 2)"
        ip: "N/A (Hardwired)"
      - id: "C2_SENS"
        label: "Sensor (Cell 2)"
        ip: "N/A (Hardwired)"
      # Cell 3
      - id: "C3_ACT"
        label: "Actuator (Cell 3)"
        ip: "N/A (Hardwired)"
      - id: "C3_PUMP"
        label: "Pump (Cell 3)"
        ip: "N/A (Hardwired)"
      - id: "C3_SENS"
        label: "Sensor (Cell 3)"
        ip: "N/A (Hardwired)"

conduits:
  # --- L5 Connections ---
  - src: "INTERNET"
    dst: "FW_L5"
    protocol: "HTTP/S, DNS"
  - src: "WEB_SVR"
    dst: "FW_L5"
    protocol: "HTTP/S"
  - src: "EMAIL_SVR"
    dst: "FW_L5"
    protocol: "SMTP, IMAP"
  
  # --- L5 -> L4 ---
  - src: "FW_L5"
    dst: "L4_SW"
    protocol: "Ethernet (Trunk)"

  # --- L4 Connections ---
  - src: "L4_AUTH"
    dst: "L4_SW"
    protocol: "LDAP/S, Kerberos"
  - src: "L4_DSK"
    dst: "L4_SW"
    protocol: "SMB, RDP, HTTP/S"
  - src: "L4_DB"
    dst: "L4_SW"
    protocol: "SQL (TDS/MySQL)"
  - src: "L4_FILE"
    dst: "L4_SW"
    protocol: "SMB/CIFS, NFS"
  - src: "L4_SW"
    dst: "FW_L4"
    protocol: "Ethernet (Trunk)"

  # --- L4 -> L3 ---
  - src: "FW_L4"
    dst: "L3_SW"
    protocol: "Ethernet (Trunk)"

  # --- L3 Connections ---
  - src: "L3_HIST"
    dst: "L3_SW"
    protocol: "OpcUa, SQL"
  - src: "L3_DC"
    dst: "L3_SW"
    protocol: "LDAP/S"
  - src: "L3_MON"
    dst: "L3_SW"
    protocol: "SNMP, Syslog"
  - src: "L3_3RD"
    dst: "L3_SW"
    protocol: "HTTPS, RDP"
  
  # --- L3 -> Cells (via Firewalls) ---
  - src: "L3_SW"
    dst: "FW_CELL1"
    protocol: "Ethernet"
  - src: "L3_SW"
    dst: "FW_CELL2"
    protocol: "Ethernet"
  - src: "L3_SW"
    dst: "FW_CELL3"
    protocol: "Ethernet"

  # --- Cell 1 Internal ---
  - src: "FW_CELL1"
    dst: "C1_DCS"
    protocol: "Ethernet"
  - src: "C1_DCS"
    dst: "C1_L2_SW1"
    protocol: "Profinet / EtherNet/IP"
  - src: "C1_L2_SW1"
    dst: "C1_IPC"
    protocol: "RDP, VNC"
  - src: "C1_L2_SW1"
    dst: "C1_HMI"
    protocol: "CIP, Modbus TCP"
  - src: "C1_IPC"
    dst: "C1_L2_SW2_L"
    protocol: "Ethernet"
  - src: "C1_HMI"
    dst: "C1_L2_SW2_R"
    protocol: "Ethernet"
  - src: "C1_L2_SW2_L"
    dst: "C1_L2_SW2_R"
    protocol: "Ethernet (Redundancy)"
  - src: "C1_L2_SW2_L"
    dst: "C1_PLC_L"
    protocol: "Ethernet"
  - src: "C1_L2_SW2_R"
    dst: "C1_PLC_R"
    protocol: "Ethernet"
  - src: "C1_L2_SW2_L"
    dst: "C1_PLC_R"
    protocol: "Ethernet"
  - src: "C1_L2_SW2_R"
    dst: "C1_PLC_L"
    protocol: "Ethernet"

  # Cell 1 L1 -> L0
  - src: "C1_PLC_L"
    dst: "C1_ACT"
    protocol: "4-20mA / Analog"
  - src: "C1_PLC_L"
    dst: "C1_PUMP"
    protocol: "Digital I/O"
  - src: "C1_PLC_R"
    dst: "C1_PUMP"
    protocol: "Digital I/O"
  - src: "C1_PLC_R"
    dst: "C1_SENS"
    protocol: "4-20mA / Analog"

  # --- Cell 2 Internal (Same Pattern) ---
  - src: "FW_CELL2"
    dst: "C2_DCS"
    protocol: "Ethernet"
  - src: "C2_DCS"
    dst: "C2_L2_SW1"
    protocol: "Profinet / EtherNet/IP"
  - src: "C2_L2_SW1"
    dst: "C2_IPC"
    protocol: "RDP"
  - src: "C2_L2_SW1"
    dst: "C2_HMI"
    protocol: "CIP"
  - src: "C2_IPC"
    dst: "C2_L2_SW2_L"
    protocol: "Ethernet"
  - src: "C2_HMI"
    dst: "C2_L2_SW2_R"
    protocol: "Ethernet"
  - src: "C2_L2_SW2_L"
    dst: "C2_L2_SW2_R"
    protocol: "Ethernet"
  - src: "C2_L2_SW2_L"
    dst: "C2_PLC_L"
    protocol: "Ethernet"
  - src: "C2_L2_SW2_L"
    dst: "C2_PLC_R"
    protocol: "Ethernet"
  - src: "C2_L2_SW2_R"
    dst: "C2_PLC_R"
    protocol: "Ethernet"
  - src: "C2_L2_SW2_R"
    dst: "C2_PLC_L"
    protocol: "Ethernet"
  - src: "C2_PLC_L"
    dst: "C2_ACT"
    protocol: "4-20mA"
  - src: "C2_PLC_L"
    dst: "C2_PUMP"
    protocol: "Digital I/O"
  - src: "C2_PLC_R"
    dst: "C2_PUMP"
    protocol: "Digital I/O"
  - src: "C2_PLC_R"
    dst: "C2_SENS"
    protocol: "4-20mA"

  # --- Cell 3 Internal (Same Pattern) ---
  - src: "FW_CELL3"
    dst: "C3_DCS"
    protocol: "Ethernet"
  - src: "C3_DCS"
    dst: "C3_L2_SW1"
    protocol: "Profinet / EtherNet/IP"
  - src: "C3_L2_SW1"
    dst: "C3_IPC"
    protocol: "RDP"
  - src: "C3_L2_SW1"
    dst: "C3_HMI"
    protocol: "CIP"
  - src: "C3_IPC"
    dst: "C3_L2_SW2_L"
    protocol: "Ethernet"
  - src: "C3_HMI"
    dst: "C3_L2_SW2_R"
    protocol: "Ethernet"
  - src: "C3_L2_SW2_L"
    dst: "C3_L2_SW2_R"
    protocol: "Ethernet"
  - src: "C3_L2_SW2_L"
    dst: "C3_PLC_L"
    protocol: "Ethernet"
  - src: "C3_L2_SW2_L"
    dst: "C3_PLC_R"
    protocol: "Ethernet"
  - src: "C3_L2_SW2_R"
    dst: "C3_PLC_R"
    protocol: "Ethernet"
  - src: "C3_L2_SW2_R"
    dst: "C3_PLC_L"
    protocol: "Ethernet"
  - src: "C3_PLC_L"
    dst: "C3_ACT"
    protocol: "4-20mA"
  - src: "C3_PLC_L"
    dst: "C3_PUMP"
    protocol: "Digital I/O"
  - src: "C3_PLC_R"
    dst: "C3_PUMP"
    protocol: "Digital I/O"
  - src: "C3_PLC_R"
    dst: "C3_SENS"
    protocol: "4-20mA"
